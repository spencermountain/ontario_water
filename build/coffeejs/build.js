// Generated by CoffeeScript 1.8.0
var analysis, assets, audios, path, resize_video, resolution, run_sync, shell, videos;

shell = require("shelljs");

path = require("path");

run_sync = require("./cmd");

analysis = require("./analysis");

assets = path.join(__dirname, 'assets');

videos = shell.ls("" + assets + "/video_master/");

audios = shell.ls("" + assets + "/audio_master/");

resolution = function(h) {
  var w;
  if (h == null) {
    h = 0;
  }
  w = parseInt(h * (16 / 9));
  return "" + w + ":" + h;
};

resize_video = function(file, h) {
  var cmd, ext, input, name, output;
  input = path.join(assets, '/video_master/', file);
  name = path.basename(input);
  ext = path.extname(name);
  output = path.join(assets, "/builds", "" + (path.basename(input, ext)) + ".mp4");
  console.log("resizing " + name + " to " + (resolution(h)));
  cmd = "ffmpeg -i " + input + " -y -vf scale=" + (resolution(h)) + " " + output;
  run_sync(cmd);
  console.log(analysis.metadata(input));
  console.log(analysis.metadata(output));
  analysis.diff(input, output);
  return output;
};

console.log(resize_video(videos[0], 486));

//# sourceMappingURL=build.js.map
